syntax = "proto3";

// buf:lint:ignore DIRECTORY_SAME_PACKAGE
package doordash.retail.catalog.v1.integrations.v1;

import "common/code.proto";
import "google/protobuf/wrappers.proto";

option go_package = "github.com/doordash/services-protobuf/generated/doordash/retail/catalog/v1/integrations/v1";
option java_generic_services = true;

// Service meant for interactions with catalog feed from
// integrated Mx
service CatalogIntegrationsService {
  // Ingest catalog feed files for an integrated Mx
  // and build catalog for necessary items
  rpc SyncMerchantCatalog(SyncMerchantCatalogRequest) returns (SyncMerchantCatalogResponse);
}

// Request for SyncMerchantCatalog
message SyncMerchantCatalogRequest {
  // Name of the integrated Mx
  string merchant_name = 1;
  // Source of the trigger
  SyncMerchantCatalogSource source = 2;
  // Optional: name of the folder in the Mx bucket
  // which contains the catalog feed
  google.protobuf.StringValue sync_folder_name = 3;
  // Optional: UUID to associate and track the request. If not
  // provided, a new UUID will be generated and provided
  // in the response.
  google.protobuf.StringValue request_id = 4;
}

// Who triggered the Mx catalog feed sync?
enum SyncMerchantCatalogSource {
  // Unspecified
  SYNC_MERCHANT_CATALOG_SOURCE_UNSPECIFIED = 0;
  // Webhook call after catalog feed has been successfully
  // created by the integration source
  SYNC_MERCHANT_CATALOG_SOURCE_MX_WEBHOOK = 1;
}

// Response for SyncMerchantCatalog
message SyncMerchantCatalogResponse {
  // UUID to associate and track the request. If request ID
  // was provided in the request, this will be the same value as that.
  // Otherwise, a new UUID will be generated by the service.
  string request_id = 1;
  // gRPC response code
  code.Code code = 20;
  // Error message if there is any
  google.protobuf.StringValue error_message = 21;
}
