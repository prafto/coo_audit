syntax = "proto3";

package com.doordash.drive.api;

import "common/common.proto";
import "common/money.proto";
import "common/order.proto";
import "common/service_client_config.proto";
import "doordash.api/annotations.proto";
import "doordash.api/field_validate.proto";
import "drive_protobuf/common.proto";
import "drive_protobuf/drive_data.proto";
import "drive_protobuf/drive_portal_errors.proto";
import "drive_protobuf/drive_public_api.proto";
import "drive_protobuf/drive_request_contexts.proto";
import "drive_protobuf/drive_utils.proto";
import "drive_protobuf/stores.proto";
import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option java_generic_services = true;
option java_multiple_files = true;
option java_outer_classname = "DrivePortal";
// buf:lint:ignore DIRECTORY_SAME_PACKAGE
option java_package = "com.doordash.drive.api.portal";
option objc_class_prefix = "HLW";

service DrivePortalAPI {
  option (service_client.client_config).circuit_breaker_config.do_ignore_grpc_code = 3;
  option (service_client.client_config).circuit_breaker_config.do_ignore_grpc_code = 5;
  option (service_client.client_config).circuit_breaker_config.do_ignore_grpc_code = 6;
  option (.doordash.api.service) = {
    name: "drive-port-api"
    url: "drive-rpc.service.prod.ddsd"
    port: 50051
    api_key_name: "API_KEY_FOR_DRIVE"
    owner: {
      id: "css-eng"
      name: "css-eng"
      slack_channel: "#proj-drive-self-help-chat"
      email_alias: "css-eng@doordash.com"
    }
    name_spaces: ["drive"]
    target_products: [INTERNAL]
  };
  rpc GetPhoneNumberByStoreId(drive_data_service.RequestById) returns (StorePhoneNumberResponse);
  rpc UpdatePhoneNumberByStoreId(UpdatePhoneNumberRequest) returns (StorePhoneNumberResponse);
  rpc GetPhoneNumberByStoreIdWithRBAC(GetPhoneNumberRequest) returns (StorePhoneNumberResponse);
  rpc UpdatePhoneNumberByStoreIdWithRBAC(UpdatePhoneNumberRequest) returns (StorePhoneNumberResponse);
  rpc GetStores(GetStoresRequest) returns (StoreSearchResponse);
  rpc CountDeliveries(CountDeliveriesRequest) returns (CountDeliveriesResponse);
  rpc SearchDeliveries(SearchDeliveriesRequest) returns (SearchDeliveriesResponse);
  rpc DeliveryDetails(DeliveryDetailsRequest) returns (DeliveryDetailsResponse);
  rpc GetDasherLocation(GetDasherLocationRequest) returns (GetDasherLocationResponse);
  rpc GetDasherPhoneNumber(GetDasherPhoneNumberRequest) returns (GetDasherPhoneNumberResponse);
  rpc GetGuestConsumerId(GetGuestConsumerIdRequest) returns (GetGuestConsumerIdResponse);
  rpc GetBusinessConfiguration(BusinessConfigurationRequest) returns (BusinessConfigurationResponse);
  rpc CheckAddresses(CheckAddressesRequest) returns (CheckAddressesResponse);
  rpc CustomerTrackingInitialState(CustomerTrackingInitialStateRequest) returns (CustomerTrackingInitialStateResponse) {
    option (google.api.http) = {
      post: "/drive/v1/customer-tracking-initial-state",
      body: "*"
    };
    option (.doordash.api.endpoint) = {
      tier: T2
      lifecycle: DEV
      authorization: [NONE]
      target_products: [CX]
    };
  }

  rpc GetCateringSetupInstructions(GetCateringSetupInstructionsRequest) returns (GetCateringSetupInstructionsResponse);
  rpc CreateCateringSetupInstructions(CreateCateringSetupInstructionsRequest) returns (CreateCateringSetupInstructionsResponse);
  rpc GeneratePresignedUrlForCateringInstructions(GeneratePresignedUrlForCateringInstructionsRequest) returns (GeneratePresignedUrlForCateringInstructionsResponse);
  rpc GetOrderTrackingData(GetOrderTrackingDataRequest) returns (GetOrderTrackingDataResponse);
  rpc GetDeliveryEstimates(GetDeliveryEstimatesRequest) returns (GetDeliveryEstimatesResponse);
  rpc CreateDelivery(CreateDeliveryRequest) returns (CreateDeliveryResponse);
  rpc CreateRedelivery(CreateRedeliveryRequest) returns (CreateDeliveryResponse);
  rpc GetWidgets(GetWidgetsRequest) returns (GetWidgetsResponse);
  rpc GetWidgetById(GetWidgetByIdRequest) returns (GetWidgetByIdResponse);
  rpc CreateWidget(CreateWidgetRequest) returns (CreateWidgetResponse);
  rpc UpdateWidgetById(UpdateWidgetByIdRequest) returns (UpdateWidgetByIdResponse);
  rpc GetOrCreateWidgetAccount(GetOrCreateWidgetAccountRequest) returns (GetOrCreateWidgetAccountResponse);
  rpc PublishWidget(PublishWidgetRequest) returns (PublishWidgetResponse);
  rpc UpdateWidgetStatus(UpdateWidgetStatusRequest) returns (UpdateWidgetStatusResponse);
  rpc GetDeliveryTrackingPageUrl(GetDeliveryTrackingPageUrlRequest) returns (GetDeliveryTrackingPageUrlResponse);
  rpc GetPortalConfigurationsForDriveForm(PortalConfigurationsForDriveFormRequest) returns (GetPortalConfigurationsForDriveFormResponse);
  rpc GetDeliveryFulfillmentDetailsForPortalOrder(DeliveryFulfillmentDetailsForPortalOrderRequest) returns (DeliveryFulfillmentDetailsForPortalOrderResponse);
  rpc UpdateOrderTrackingDelivery(UpdateOrderTrackingDeliveryRequest) returns (UpdateOrderTrackingDeliveryResponse);
  rpc GetChatUserForDrive(GetChatUserForDriveRequest) returns (GetChatUserForDriveResponse) {
    option (google.api.http) = {get: "/drive/v1/chat/user/{url_code}"};
    option (.doordash.api.endpoint) = {
      tier: T2
      lifecycle: DEV
      authorization: [NONE]
      target_products: [CX]
    };
  }
}

message GetChatUserForDriveRequest {
  google.protobuf.StringValue url_code = 1 [(.doordash.api.validate.rules).missing_value = {action: FAIL}];
  google.protobuf.StringValue accept_language = 2 [(.doordash.api.inject_from_headers) = {
    field: "accept-language"
    injection_rule: {cast_type: "nullable_string"}
  }];
  google.protobuf.StringValue user_agent = 3 [(.doordash.api.inject_from_headers) = {
    field: "user-agent"
    injection_rule: {cast_type: "nullable_string"}
  }];
}

message GetChatUserForDriveResponse {
  google.protobuf.StringValue chat_user_id = 1;
  google.protobuf.StringValue chat_user_access_token = 2;
  google.protobuf.StringValue channel_url = 3;
  google.protobuf.StringValue application_id = 4;
}

message StoreIdentifierById {
  // store id
  google.protobuf.Int64Value id = 1;
}

// Multiple ways to identify/resolve to a DoorDash store
message StoreIdentifiers {
  // store id
  StoreIdentifierById identifier_by_id = 1;
}

message SchedulingDetails {
  google.protobuf.Timestamp pickup_time = 1;
  google.protobuf.Timestamp dropoff_time = 2;
}

message AddressCoordinates {
  google.protobuf.DoubleValue lat = 1;
  google.protobuf.DoubleValue lng = 2;
  google.protobuf.StringValue printable_address = 3;
  google.protobuf.StringValue subpremise = 4;
}

message GetDeliveryEstimatesRequest {
  message StoreDetails {
    StoreIdentifiers identifiers = 1;
  }

  message OrderDetails {
    // order subtotal
    google.protobuf.Int32Value subtotal = 1;
  }

  message PickupDetails {
    AddressCoordinates pickup_address = 1;
  }

  message DropoffDetails {
    AddressCoordinates dropoff_address = 1;
  }

  reserved 1;

  StoreDetails store_details = 2;
  OrderDetails order_details = 3;
  SchedulingDetails scheduling_details = 4;
  PickupDetails pickup_details = 5;
  DropoffDetails dropoff_details = 6;
  com.doordash.drive.api.request_contexts.v1.RequestSubmissionContext submission_context = 7;
}

message GetDeliveryEstimatesResponse {
  // Response should contain the delivery estimates result (data), otherwise an error if something went wrong
  oneof result {
    com.doordash.drive.api.portal.errors.v1.ErrorData error = 1;
    DeliveryEstimatesData data = 2;
  }
}

message DeliveryEstimatesData {
  message MerchantFees {
    money.MonetaryFields delivery_fee = 1;
  }

  // Estimated scheduling info for the delivery
  SchedulingDetails scheduling_details = 1;
  // Estimated fees charged to the merchant
  MerchantFees merchant_fees = 2;
}

message CreateDeliveryRequest {
  StoreDetails store = 1;
  Consumer consumer = 2;
  OrderDetails order_details = 3;
  PaymentDetails payment_details = 4;
  PickupDetails pickup_details = 5;
  DropoffDetails dropoff_details = 6;
  SchedulingDetails scheduling_details = 7;
  com.doordash.drive.api.request_contexts.v1.RequestSubmissionContext submission_context = 8;

  message StoreDetails {
    // Id can either be a store id or an external store id.
    oneof id {
      StoreIdentifierById store_identifier = 1;
      StoreIdentifierByExternalStoreId external_store_identifier = 2;
    }

    message StoreIdentifierByExternalStoreId {
      google.protobuf.StringValue id = 1;
      google.protobuf.StringValue business_id = 2;
    }
  }

  message OrderDetails {
    CreateDeliveryConfig config = 1;
    google.protobuf.Int32Value subtotal = 2;
    google.protobuf.Int32Value total = 3;
    google.protobuf.Int32Value driver_tip = 4;
    google.protobuf.Int32Value total_items_count = 5;
    google.protobuf.StringValue order_reference = 6;
    google.protobuf.StringValue external_delivery_id = 7;
    google.protobuf.Int32Value order_volume = 8;
    repeated com.doordash.drive.DriveOrderItem items = 9;
    drive_utils_service.v1.DriverTipDetails driver_tip_details = 10;

    message CreateDeliveryConfig {
      bool is_cash_order = 1;
      bool contains_alcohol = 2;
      bool requires_catering_setup = 3;
      OrderContains order_contains = 4 [deprecated = true];
      google.protobuf.BoolValue requires_id_verification = 5 [deprecated = true];
      // list of item types contained in the order eg: otc, prescription
      repeated OrderContains order_contains_list = 6;
      // dropoff type for the order
      OrderDropoffType dropoff_type = 7;
      // signature status of the order
      google.protobuf.BoolValue requires_signature = 8;
      // return action for the order
      OrderReturnAction return_type = 9;
      // Dropoff pin code verification metadata
      PinCodeVerificationMetadata dropoff_pin_code_verification_metadata = 10;
      // Require barcode scanning
      google.protobuf.BoolValue barcode_scanning_required = 11;
    }

    // The Order's Dropoff Type
    enum OrderDropoffType {
      // Default
      ORDER_DROPOFF_TYPE_UNSPECIFIED = 0;
      // Hand it to me
      ORDER_DROPOFF_TYPE_HAND_IT_TO_ME = 1;
      // Contactless
      ORDER_DROPOFF_TYPE_CONTACTLESS = 2;
    }

    // Action to be taken upon return for the order
    enum OrderReturnAction {
      // Default
      ORDER_RETURN_ACTION_UNSPECIFIED = 0;
      // Return the order to store
      ORDER_RETURN_ACTION_RETURN_TO_STORE = 1;
      // Leave the order unattended
      ORDER_RETURN_ACTION_LEAVE_UNATTENDED = 2;
    }
  }

  message PaymentDetails {
    PaymentMethod payment_method = 1;
    PayerDetails payer_details = 2;

    // Payment Method Enum
    enum PaymentMethod {
      // Default
      PAYMENT_METHOD_UNSPECIFIED = 0;
      // Credit card
      PAYMENT_METHOD_CREDIT_CARD = 1;
      // Invoice
      PAYMENT_METHOD_INVOICE = 2;
      // Cash
      PAYMENT_METHOD_CASH = 3;
    }

    // Payer Entity Type Enum
    enum PayerEntityType {
      // Default
      PAYER_ENTITY_TYPE_UNSPECIFIED = 0;
      // Store
      PAYER_ENTITY_TYPE_STORE = 1;
      // Business
      PAYER_ENTITY_TYPE_BUSINESS = 2;
    }

    message PayerDetails {
      google.protobuf.StringValue entity_id = 1;
      PayerEntityType entity_type = 2;
    }
  }

  message PickupDetails {
    AddressCoordinates pickup_address = 1;
    google.protobuf.StringValue business_name = 2;
    google.protobuf.StringValue pickup_instructions = 3;
    google.protobuf.StringValue phone_number = 4;
  }

  message DropoffDetails {
    // Dropoff address can be either coordinates or address component.
    oneof dropoff_address {
      AddressCoordinates address_coordinates = 1;
      CreateDeliveryRequest.Address address = 2;
    }
    google.protobuf.StringValue dropoff_instructions = 3;
  }

  message SchedulingDetails {
    // Scheduling details can be a dropoff time, a pickup time, or a scheduling window.
    oneof time {
      google.protobuf.Timestamp dropoff_time = 1;
      google.protobuf.Timestamp pickup_time = 2;
      SchedulingWindowsDetails scheduling_windows_details = 3;
    }
  }

  message SchedulingWindowsDetails {
    SchedulingWindow dropoff_window = 1;
    SchedulingWindow pickup_window = 2;

    message SchedulingWindow {
      google.protobuf.Timestamp window_start_time = 1;
      google.protobuf.Timestamp window_end_time = 2;
    }
  }

  message Address {
    google.protobuf.StringValue street = 1;
    google.protobuf.StringValue subpremise = 2;
    google.protobuf.StringValue city = 3;
    google.protobuf.StringValue state = 4;
    google.protobuf.StringValue zip_code = 5;
  }
}

message CreateDeliveryResponse {
  // Result can be either an error or a doordash id.
  oneof result {
    com.doordash.drive.api.portal.errors.v1.ErrorData error = 1;
    Data data = 2;
  }

  message Data {
    google.protobuf.StringValue doordash_id = 1;
  }
}

message CreateRedeliveryRequest {
  google.protobuf.StringValue doordash_id = 1;
  com.doordash.drive.api.request_contexts.v1.RequestSubmissionContext submission_context = 2;

  /* optional fields for overriding properties of the order for which to create a redelivery
     if not supplied, the properties of the original order will be used */
  Consumer consumer = 3;
  CreateDeliveryRequest.OrderDetails order_details = 4;
  CreateDeliveryRequest.PaymentDetails payment_details = 5;
  CreateDeliveryRequest.PickupDetails pickup_details = 6;
  CreateDeliveryRequest.DropoffDetails dropoff_details = 7;
  CreateDeliveryRequest.SchedulingDetails scheduling_details = 8;
  // ExternalStoreId used by Parcels. This id is not persisted in DriveDB. The existing workfow uses it from CreateDeliveryRequest directly.
  CreateDeliveryRequest.StoreDetails.StoreIdentifierByExternalStoreId external_store_identifier = 9;
}

message GetOrderTrackingDataRequest {
  message Identifiers {
    // Various identifiers to look up an order for tracking page purposes
    oneof identifier {
      google.protobuf.StringValue unspecified_identifier = 1;
      google.protobuf.StringValue url_code = 2;
      google.protobuf.StringValue delivery_uuid = 3;
      google.protobuf.StringValue tracking_number = 4;

      // For a temporary experimental feature to track regular orders. See
      // https://docs.google.com/document/d/11Zubmn7URG4rzN4Cwbsay4i2hnlrxg1t6uXC7ZbeyPA/edit?tab=t.0
      google.protobuf.StringValue order_uuid = 5;
    }
  }

  // Optional flags when requesting order tracking data
  message Options {
    bool live_order_details_only = 1;
  }

  google.protobuf.StringValue url_code = 1;
  bool is_storefront = 2;
  Identifiers identifiers = 3;
  com.doordash.drive.api.request_contexts.v1.RequestSubmissionContext submission_context = 4;
  Options options = 5;
}

// Contains parcel specific tracking details
message ParcelDetails {
  message ParcelOriginDetails {
    // location of the Mx Warehouse
    .common.Location location = 1;
  }
  // Details related to the origin of where the parcel is coming from; usually a merchant's warehouse
  ParcelOriginDetails origin_details = 1;
}

message GetOrderTrackingDataResponse {
  message PickupDetails {
    Address address = 1;
  }

  message DropoffDetails {
    // Indicated Dropoff Type of the delivery
    enum DropoffType {
      // Dropoff Type is unknown
      DROPOFF_TYPE_UNSPECIFIED = 0;
      // Dropoff Type is to hand it to cx
      DROPOFF_TYPE_HAND_IT_TO_ME = 1;
      // Dropoff Type is contactless
      DROPOFF_TYPE_CONTACTLESS = 2;
      // Dropoff Type needs a signature
      DROPOFF_TYPE_SIGNATURE_REQUIRED = 3;
    }
    Address address = 1;
    google.protobuf.StringValue dasher_instructions = 2;
    DropoffType dropoff_type = 3;
    DropoffInstructionDetails dropoff_instruction_details = 4;
    DropoffVerificationMethodDetails dropoff_verification_method_details = 5;
  }

  // Details of delivery dropoff verification method
  message DropoffVerificationMethodDetails {
    // Details for PIN code verification
    message PinCodeVerificationDetails {
      // Localized display string for PIN code description containing PIN code itself. ex. "PIN code required: 8312"
      google.protobuf.StringValue pin_code_display_description = 1;
    }

    // Data for PIN code verification
    PinCodeVerificationDetails pin_code_verification_details = 1;
  }

  // Contains specific details of delivery dropoff instructions
  message DropoffInstructions {
    // Only consists of cx dropoff instructions
    google.protobuf.StringValue cx_dropoff_instructions = 1;
    // Dropoff building name
    google.protobuf.StringValue building_name = 2;
    // Dropoff entry code for the address
    google.protobuf.StringValue entry_code = 3;
    // Dropoff subpremise info for the address
    google.protobuf.StringValue subpremise = 4;
  }

  // Contains Delivery Dropoff Instruction Details and Editability
  message DropoffInstructionDetails {
    // Specific Details of the Dropoff Instructions
    DropoffInstructions dropoff_instructions = 1;
    // Whether the instructions are editable or not
    google.protobuf.BoolValue is_editable = 2;
  }

  message TimestampFields {
    google.protobuf.Timestamp quoted_delivery_time = 1;
    google.protobuf.Timestamp actual_pickup_time = 2;
    google.protobuf.Timestamp actual_delivery_time = 3;
    google.protobuf.Timestamp quoted_pickup_time = 4;
    google.protobuf.Timestamp driver_confirmed_at_pickup_time = 5;
    google.protobuf.Timestamp driver_confirmed_at_dropoff_time = 6;
    google.protobuf.Timestamp created_at = 7;
  }

  message Identifiers {
    string delivery_uuid = 1;
    google.protobuf.StringValue doordash_drive_id = 2;
    google.protobuf.StringValue drive_external_order_reference = 3;
    google.protobuf.StringValue url_code = 4;
    // Return optional tracking number if Cx provides valid tracking number
    google.protobuf.StringValue tracking_number = 5;
    // This is populated by external_delivery_id in drive_order
    google.protobuf.StringValue external_delivery_id = 6;
    google.protobuf.StringValue order_uuid = 7;
  }

  message FinancialDetails {
    money.MonetaryFields subtotal = 1;
    money.MonetaryFields pre_tip = 2;
    money.MonetaryFields post_tip = 3;
  }

  // Holds all data for the event history of an order
  message EventHistory {
    // Additional details related to a single event in the event history
    message EventDetails {
      // Additional notes related to a single event
      google.protobuf.StringValue additional_notes = 1;
    }

    // Holds all data related to a single event in the event history
    message EventHistoryInfo {
      // Localized primary string tied to a single event - eg: Driver waiting for order
      string event_status_display_string = 1;
      // Time in UTC of when the event occurred
      google.protobuf.Timestamp event_time = 2;
      // Formatted string representing where the event occurred - eg: Santa Monica, CA
      google.protobuf.StringValue location_display_string = 3;
      // Additional event details
      EventDetails details = 4;
    }

    // List of all the events that need to be rendered in the event history
    repeated EventHistoryInfo events = 1;
    // Primary title of the event history  - eg: Shipment Tracking
    string title = 2;
  }

  message OrderDetails {
    // order type of the order
    enum OrderType {
      // Order Type is Unknown
      ORDER_TYPE_UNSPECIFIED = 0;
      // Order Type is a parcel order
      ORDER_TYPE_PARCEL = 1;
      // Order Type is a Dasher Shop Deliver order
      ORDER_TYPE_GROCERY_DSD = 2;
      // Order Type is a Dasher Shop Stage order
      ORDER_TYPE_GROCERY_DSS = 3;
    }

    google.protobuf.Int32Value quantity = 1;
    google.protobuf.Int64Value subtotal = 2;
    google.protobuf.Int32Value pre_tip_amount = 3;
    google.protobuf.Int32Value post_tip_amount = 4;
    google.protobuf.Int32Value dasher_wait_remaining_seconds = 5;
    order.LiveOrderDetails live_order_details = 6;
    FinancialDetails financial_details = 7;
    OrderType order_type = 8;
    // event history of an order
    EventHistory event_history = 9;
  }

  // Additional meta data specific to order types
  message AdditionalOrderTypeMetadata {
    ParcelDetails parcel_details = 1;
  }

  PickupDetails pickup_details = 1;
  DropoffDetails delivery_details = 2;
  TimestampFields timestamps = 3;
  Identifiers identifiers = 4;
  Dasher dasher = 5;
  DriveInternalStatus drive_internal_status = 6;
  Store store = 7;
  Consumer consumer = 8;
  OrderDetails order_details = 9;
  DeliveryVerification delivery_verification = 10;
  // Optional. Not all Drive deliveries have developer associated.
  Developer developer = 11;
  AdditionalOrderTypeMetadata additional_order_type_metadata = 12;
}

message CustomerTrackingInitialStateResponse {
  message Identifiers {
    string delivery_uuid = 1;
    google.protobuf.StringValue doordash_drive_id = 2;
    // This is populated by external_order_reference in drive order
    google.protobuf.StringValue drive_external_order_reference = 3;
    google.protobuf.StringValue url_code = 4;
    // Return optional tracking number if Cx provides valid tracking number
    google.protobuf.StringValue tracking_number = 5;
    // This is populated by external_delivery_id in drive_order
    google.protobuf.StringValue external_delivery_id = 6;

    // Return optional order UUID if the order is a regular non-Drive order.
    google.protobuf.StringValue order_uuid = 7;
  }

  message LegacySettings {
    message CustomLayoutSettings {
      google.protobuf.StringValue header_logo_image_url = 1;
      google.protobuf.BoolValue show_cobranding = 2;
      google.protobuf.BoolValue show_order_details = 3;
      google.protobuf.BoolValue show_header = 4;
      OrderConfirmBannerDetails order_confirm_banner_details = 5;
      // Show or hide component for Cx substitution preferences
      SubstitutionComponentDetails substitution_component_details = 6;
      DropoffComponentDetails dropoff_component_details = 7;
      PickupComponentDetails pickup_component_details = 8;
      repeated Banner banners = 9;
    }

    message Banner {
      message Button {
        // The text that will be shown on the button
        google.protobuf.StringValue button_text_template = 1;
        // Optional: A url that can be used to direct a user when clicking on the banner
        google.protobuf.StringValue url = 2;
      }
      // Enum for the name of the banners on tracking page
      enum BannerName {
        // Default if banner name is no specified
        BANNER_NAME_UNSPECIFIED = 0;
        // Banner name for pay on delivery flow
        BANNER_NAME_PAY_ON_DELIVERY = 1;
      }

      BannerName name = 1;
      // Tells us how to organize the banners i.e. setting it to 1 means show this banner first, 2 means to show it after, etc…
      int32 sort_order = 2;
      // Optional: Metadata to help populate or render the banner.  “store_name” -> “McDonald’s”
      map<string, string> metadata = 3;
      // The text that will be shown first, can be used as template to embed values provided from metadata
      // e.g. “Click me to pay for your order from {{store_name}}”
      google.protobuf.StringValue primary_text_template = 4;
      // Same as above except this could be used for other subtexts if needed
      google.protobuf.StringValue secondary_text_template = 5;
      // button to be shown on the banner
      Button primary_button = 6;
      // button to be shown on the banner if needed
      Button secondary_button = 7;
    }

    message SupportContactModules {
      message SupportPhoneNumberComponent {
        // Contact method of the support phone number
        enum SupportPhoneNumberContactMethod {
          // Unspecified phone number type
          SUPPORT_PHONE_NUMBER_CONTACT_METHOD_UNSPECIFIED = 0;
          // Phone call support entrypoint
          SUPPORT_PHONE_NUMBER_CONTACT_METHOD_PHONE_CALL = 1;
          // SMS support entrypoint
          SUPPORT_PHONE_NUMBER_CONTACT_METHOD_SMS = 2;
        }
        // Prefer to use the support_phone_numbers field instead of this one as the support_phone_numbers can handle multiple phone numbers flexibly
        .common.PhoneNumberComponents phone_number = 1;
        // Contact method to differentiate between different ways the phone number can be used in context of support help.
        SupportPhoneNumberContactMethod contact_method = 2;
        // Sort order -- if multiple support numbers are in an array, we can use this value to decide which order to render the components
        // e.g. sort_order = 1 means show this first, 2 means show this 2nd, 3 means show this third, etc.
        google.protobuf.Int32Value sort_order = 3;
      }
      .common.PhoneNumberComponents support_phone_number = 1;
      .common.EmailAddressComponents support_email_address = 2;
      FreeformTextComponents freeform_support_text = 3;

      // General multi-purpose support phone numbers list
      repeated SupportPhoneNumberComponent support_phone_numbers = 4;
    }

    message MerchantSupportConfig {
      SupportContactModules contact_modules = 1;
    }

    message SupportDetails {
      MerchantSupportConfig merchant_config = 1;
    }

    message SupportUIConfig {
      // Type of support offered to the cx.
      enum SupportType {
        // Default
        SUPPORT_TYPE_UNSPECIFIED = 0;
        // Support option to let cx chat with CSS support agent.
        SUPPORT_TYPE_CHAT = 1;
        // Support option that let cx call a support line.
        SUPPORT_TYPE_PHONE = 2;
        // Support option that let cx send an email to merchant.
        SUPPORT_TYPE_EMAIL = 3;
        // Freeform support text that tells how to get help for this order.
        SUPPORT_TYPE_FREEFORM = 4;
      }

      message SupportOption {
        // Type of support: email/chat etc.
        SupportType support_type = 1;
        // If true, UI will show a 'recommended' tag for this type.
        google.protobuf.BoolValue is_recommended = 2;
        // Phone number, only set when support type is phone.
        google.protobuf.StringValue phone_number = 3;
        // Phone number, only set when support type is phone.
        google.protobuf.StringValue phone_number_display = 4;
        // Merchant email, only set when support type is email.
        google.protobuf.StringValue email = 5;
        // Freeform support text, only set when support type is freeform.
        google.protobuf.StringValue freeform_support_text = 6;
      }

      // Whether the mx is part of "customer support solutions" offering.
      google.protobuf.BoolValue is_css_merchant = 1;
      // List of support options displayed on the help page that opens from tracking page.
      repeated SupportOption support_options = 2;
    }

    message OrderConfirmBannerDetails {
      google.protobuf.BoolValue showCashOnDeliveryOrderConfirmBanner = 1;
    }

    message SubstitutionComponentDetails {
      google.protobuf.BoolValue show_component = 1;
    }

    message DropoffComponentDetails {
      google.protobuf.BoolValue show_component = 1;
    }

    message PickupComponentDetails {
      google.protobuf.BoolValue show_component = 1;
    }

    google.protobuf.StringValue cobranding_logo_image_url = 1;
    SupportDetails support_details = 2;
    // This'll replace the support_details field, once fully launched.
    SupportUIConfig support_ui_config = 4;
    CustomLayoutSettings custom_layout_settings = 3;
  }

  bool is_customer_tracking_tip_enabled = 1;
  google.protobuf.StringValue tracking_page_phone_number = 2;
  google.protobuf.StringValue web_sha = 3;
  CustomerTrackingStoreData store_data = 4;
  LegacySettings legacy_settings = 5;
  Identifiers identifiers = 6;
}

message FreeformTextComponents {
  // Example: "Question about your order or payment issues? Call 555-555-5555 or email support@mycompany.com"
  google.protobuf.StringValue value = 1;
  // Example: FREEFORM_TEXT_FORMAT_PLAINTEXT, which describes that the value is a simple text string
  FreeformTextFormat format = 2;
}

// Freeform text format enum that helps describe what format the freeform text value is in
enum FreeformTextFormat {
  // Default
  FREEFORM_TEXT_FORMAT_UNSPECIFIED = 0;
  // plaintext
  FREEFORM_TEXT_FORMAT_PLAINTEXT = 1;
}

message CustomerTrackingStoreData {
  CustomerTrackingAddress address = 1;
  CustomerTrackingBusiness business = 2;
  google.protobuf.StringValue id = 3;
  bool is_test = 4;
  google.protobuf.StringValue name = 5;
  google.protobuf.StringValue timezone = 6;
  google.protobuf.StringValue phone_number = 7;
}

message CustomerTrackingAddress {
  google.protobuf.StringValue city = 1;
  google.protobuf.StringValue country = 2;
  google.protobuf.StringValue printable_address = 3;
  google.protobuf.StringValue shortname = 4;
  google.protobuf.StringValue state = 5;
  google.protobuf.StringValue street = 6;
  google.protobuf.StringValue sub_premise = 7;
  google.protobuf.StringValue zip_code = 8;
  google.protobuf.StringValue id = 9;
  google.protobuf.DoubleValue lat = 10;
  google.protobuf.DoubleValue lng = 11;
}

message CustomerTrackingBusiness {
  google.protobuf.StringValue description = 1;
  google.protobuf.StringValue id = 2;
  bool is_test = 3;
  google.protobuf.StringValue name = 4;
  google.protobuf.StringValue stripe_customer = 5;
}

message CustomerTrackingInitialStateRequest {
  message Identifiers {
    // Various identifiers to look up an order for tracking page purposes
    oneof identifier {
      google.protobuf.StringValue unspecified_identifier = 1;
      google.protobuf.StringValue url_code = 2;
      google.protobuf.StringValue delivery_uuid = 3;
      google.protobuf.StringValue tracking_number = 4;

      // For a temporary experimental feature to track regular orders. See
      // https://docs.google.com/document/d/11Zubmn7URG4rzN4Cwbsay4i2hnlrxg1t6uXC7ZbeyPA/edit?tab=t.0
      google.protobuf.StringValue order_uuid = 5;
    }
  }

  google.protobuf.StringValue tracking_url_code = 1;
  bool is_storefront = 2;
  // Optional identifiers field, TODO: deprecate the tracking_url_code
  Identifiers identifiers = 3;
}

message CheckAddressesRequest {
  google.protobuf.StringValue pickup_address = 1;
  google.protobuf.StringValue dropoff_address = 2;
  google.protobuf.StringValue store_id = 3;
  google.protobuf.Int32Value order_value = 4;
}

message CheckAddressesResponse {
  repeated google.protobuf.StringValue errors = 1;
  google.protobuf.BoolValue valid = 2;
}

message GetCateringSetupInstructionsRequest {
  int64 store_id = 1;
}

message GetCateringSetupInstructionsResponse {
  google.protobuf.StringValue instructions_url = 1;
}

message CreateCateringSetupInstructionsRequest {
  string image_url = 1;
  google.protobuf.Int64Value store_id = 2;
}

message CreateCateringSetupInstructionsResponse {}

message GeneratePresignedUrlForCateringInstructionsRequest {
  google.protobuf.Int64Value store_id = 1;
}

message GeneratePresignedUrlForCateringInstructionsResponse {
  string presigned_url = 1;
}

message GetDasherLocationRequest {
  google.protobuf.StringValue uuid = 1;
  bool is_storefront = 2;
}

message GetDasherLocationResponse {
  google.protobuf.DoubleValue lat = 1;
  google.protobuf.DoubleValue lng = 2;
}

message GetDasherPhoneNumberRequest {
  google.protobuf.StringValue uuid = 1; // unique url code for the delivery
}

message GetDasherPhoneNumberResponse {
  google.protobuf.StringValue phone_number = 1; // Dasher's phone number
  bool is_textable = 2; // boolean value to identify whether customer is allowed to text dasher.
}

message GetGuestConsumerIdRequest {
  google.protobuf.StringValue url_code = 1;
}

message GetGuestConsumerIdResponse {
  // Guest consumer id
  // This can be used to get Cx subs preferences from RFS
  google.protobuf.StringValue guest_consumer_id = 1;
}

// Placeholder
message DeliveryDetailsResponse {}

message DeliveryDetailsRequest {
  google.protobuf.StringValue delivery_uuid = 1;
  google.protobuf.StringValue doordash_id = 2;
}

message SearchDeliveriesRequest {
  google.protobuf.StringValue search_term = 1;
  google.protobuf.Int64Value business_id = 2;
  google.protobuf.Timestamp active_date = 3;
  bool is_completed = 4;
  bool is_cancelled = 5;
  google.protobuf.Int32Value offset = 6;
  google.protobuf.Int32Value limit = 7;
  google.protobuf.Timestamp filter_start_time = 8;
  google.protobuf.Timestamp filter_end_time = 9;
  int64 user_id = 10;
  repeated int64 store_ids = 11;
}

message SearchDeliveriesResponse {
  repeated PortalDelivery deliveries = 1;
}

message PortalDelivery {
  google.protobuf.Timestamp pickup_window_start_time = 1;
  google.protobuf.StringValue url_code = 2;
  repeated CateringVerification catering_verifications = 3;
  CancellationDetail cancellation_detail = 4;
  google.protobuf.Timestamp estimated_pickup_time = 5;
  google.protobuf.Timestamp pickup_window_end_time = 6;
  repeated Order orders = 7;
  google.protobuf.Timestamp dasher_at_store_time = 8;
  google.protobuf.Timestamp dasher_confirmed_at_store_time = 9;
  google.protobuf.Timestamp dasher_approaching_customer_time = 10;
  google.protobuf.StringValue dasher_instructions = 11;
  google.protobuf.StringValue pickup_instructions = 12;
  Store store = 13;
  google.protobuf.Int64Value dasher_id = 14;
  Dasher dasher = 15;
  google.protobuf.Timestamp quoted_delivery_time = 16;
  google.protobuf.Timestamp abandoned_at = 17;
  google.protobuf.Timestamp actual_pickup_time = 18;
  google.protobuf.Timestamp actual_delivery_time = 19;
  google.protobuf.Timestamp dasher_confirmed_at_consumer_time = 20;
  google.protobuf.Timestamp customer_unavailable_escalated_at = 21;
  google.protobuf.Int32Value merchant_dasher_rating = 22;
  PickupAddress pickup_address = 23;
  google.protobuf.Timestamp dasher_confirmed_time = 24;
  google.protobuf.Int32Value commission_tax = 25;
  google.protobuf.Int32Value subtotal = 26;
  repeated Receipt receipts = 27;
  DeliveryAddress deliveryAddress = 28;
  google.protobuf.Int32Value fee = 29;
  google.protobuf.Int32Value post_tip_amount = 30;
  bool mx_equipped_dasher_with_pizza_bag = 31;
  google.protobuf.Timestamp created_at = 32;
  Consumer consumer = 33;
  OrderCart order_cart = 34;
  google.protobuf.Int64Value drive_external_order_reference = 35;
  DriveInternalStatus drive_internal_status = 36;
  string drive_order_type = 37;
  int32 quantity = 38;
  google.protobuf.StringValue dasher_wait_remaining_seconds = 39;
  google.protobuf.Int64Value return_delivery_id = 40;
  google.protobuf.Int64Value original_delivery_id = 41;
  DeliveryVerification delivery_verification = 42;
}

message DeliveryVerification {
  google.protobuf.StringValue photo_url = 1;
  google.protobuf.StringValue location_description = 2;
  google.protobuf.DoubleValue lat = 3;
  google.protobuf.DoubleValue lng = 4;
  google.protobuf.DoubleValue distance_from_customer = 5;
  google.protobuf.DoubleValue accuracy_meters = 6;
  google.protobuf.Timestamp created_at = 7;
}

message DriveInternalStatus {
  string category = 1;
  string urgency = 2;
  MetaData metadata = 3;
  google.protobuf.StringValue last_changed = 4;
}

message MetaData {
  google.protobuf.Int32Value travel_duration_seconds = 1;
  google.protobuf.Int32Value travel_distance_meters = 2;
  google.protobuf.Int32Value number_of_texts = 3;
  google.protobuf.Timestamp dynamic_delivery_time = 4;
  google.protobuf.BoolValue confirmed_by_dasher = 5;
}

message OrderCart {
  int64 id = 1;
  google.protobuf.Timestamp submitted_at = 2;
  string url_code = 3;
  google.protobuf.Int32Value tip_amount = 4;
  int64 creator = 5;
}

message Consumer {
  string first_name = 1;
  string last_name = 2;
  google.protobuf.StringValue business_name = 3;
  string phone_number = 4;
  google.protobuf.StringValue email = 5;
}

message DeliveryAddress {
  int64 id = 1;
  string subpremise = 2;
  string dasherInstructions = 3;
  Address address = 4;
}

message Receipt {
  int64 id = 1;
  string image_url = 2;
  bool viewed_by_merchant = 3;
  int32 tip_amount = 4;
}

message PickupAddress {
  string dasher_instructions = 1;
  google.protobuf.StringValue parking_tips = 2;
  Address address = 3;
}

message Dasher {
  int64 id = 1;
  string phone_number = 2;
  string first_name = 3;
  string last_name = 4;
  google.protobuf.BoolValue is_preferred = 5;
  google.protobuf.BoolValue is_blacklisted = 6;
  LocationCoordinate location = 7;
  repeated LocationCoordinate route = 8;
  .common.PhoneNumberComponents phone_number_components = 9;
}

message LocationCoordinate {
  double lat = 1;
  double long = 2;
}

message Store {
  int64 id = 1;
  string name = 2;
  string timezone = 3;
  Address address = 4;
  string phone_number = 5;
  Business business = 6;
}

message Business {
  int64 id = 1;
  string description = 2;
  string name = 3;
}

message Developer {
  int64 id = 1;
}

message Address {
  int64 id = 1;
  string city = 2;
  string subpremise = 3;
  string printable_address = 4;
  string state = 5;
  string street = 6;
  string country = 7;
  double lat = 8;
  double lng = 9;
  string shortname = 10;
  string zip_code = 11;
}

message Order {
  int64 id = 1;
  repeated OrderItemEntity order_items = 2;
}

message OrderItemEntity {
  int64 id = 1;
  string name = 2;
  google.protobuf.StringValue substitution_preference = 3;
  OrderItem item = 4;
  int32 additional_cost = 5;
  string special_instructions = 6;
  int32 quantity = 7;
}

message OrderItem {
  int64 id = 1;
  string description = 2;
  int32 price = 3;
  int32 min_age_requirement = 4;
  bool is_active = 5;
  int64 menu_item_numer = 6;
  int32 base_price = 7;
  string name = 8;
}

message CancellationDetail {
  google.protobuf.Timestamp cancelled_at = 1;
  google.protobuf.StringValue cancelled_by = 2;
  google.protobuf.StringValue cancelled_reason = 3;
}

message CateringVerification {
  google.protobuf.Int64Value id = 1;
  google.protobuf.BoolValue setup_waived = 2;
  google.protobuf.StringValue setup_photo_url = 3;
}

message CountDeliveriesRequest {
  bool is_completed = 1;
  bool is_cancelled = 2;
  google.protobuf.Int64Value business_id = 3;
  repeated int64 store_ids = 4;
  google.protobuf.Timestamp start_time = 5;
  google.protobuf.Timestamp end_time = 6;
  google.protobuf.StringValue search_term = 7;
}

message CountDeliveriesResponse {
  int64 count = 1;
}

// Notification Phone Numbers

message GetPhoneNumberRequest {
  int64 store_id = 1;
  common.DriveUser user = 2;
}

message UpdatePhoneNumberRequest {
  int64 store_id = 1;
  string notifications_phone_number = 2;
  common.DriveUser user = 3;
}

message StorePhoneNumberResponse {
  google.protobuf.StringValue message = 1;
  google.protobuf.StringValue notifications_phone_number = 2;
  google.protobuf.BoolValue are_notifications_enabled = 3;
}

// Drive Store Search

message GetStoresRequest {
  repeated google.protobuf.StringValue fields = 1;
  google.protobuf.Int32Value limit = 2;
  google.protobuf.Int32Value offset = 3;
  google.protobuf.StringValue city = 4;
  google.protobuf.Int64Value business_id = 5;
  google.protobuf.BoolValue count_only = 6;
  common.DriveUser user = 7;
}

message StoreSearchResponse {
  repeated StoreResponse stores = 1;
  google.protobuf.Int64Value count = 2;
}

message BusinessConfigurationRequest {
  // Merchant business ID to get business configuration data
  google.protobuf.Int64Value business_id = 1;
  // Options to include extra data. By default, everything will be false.
  BusinessConfigurationOptions business_options = 2;
}

// Options to include additional data for a business.
message BusinessConfigurationOptions {
  // Whether we want to include drive active drive partnerships of the business.
  bool include_drive_partnerships = 1;
  // Whether we want to include catering setup instructions.
  bool include_catering_setup_instructions = 2;
}

message BusinessConfigurationResponse {
  google.protobuf.StringValue super_category = 1;
  google.protobuf.StringValue mega_category = 2;
  google.protobuf.StringValue primary_subcategory = 3;
  google.protobuf.BoolValue supports_cash = 4;
  google.protobuf.BoolValue supports_post_tip = 5;
  // Contains drive partnership-related information for the business.
  BusinessDrivePartnershipDetails partnerships_details = 6;
  // Contains catering setup instructions for the business.
  CateringSetupInstructions catering_setup_instructions = 7;
}

message BusinessDrivePartnershipDetails {
  // Contains active drive partnerships for the business.
  repeated drive_data_service.DrivePartnership partnerships = 1;
}

message WidgetMetadata {
  google.protobuf.StringValue widget_id = 1;
  WidgetStatus widget_status = 2;
  google.protobuf.StringValue widget_name = 3;
  google.protobuf.StringValue merchant_website_url = 4;
}
message Widget {
  google.protobuf.StringValue id = 1;
  WidgetMetadata metadata = 2;
  google.protobuf.StringValue content = 3;
}

message WidgetOptions {
  WidgetContentType content_type = 1;
}

// Describes which file to interact with for the widget
enum WidgetContentType {
  // Default
  WIDGET_CONTENT_TYPE_UNSPECIFIED = 0;
  // Update or fetch the draft version of widget
  WIDGET_CONTENT_TYPE_PREVIEW = 1;
  // Update or fetch the final published version of widget
  WIDGET_CONTENT_TYPE_PUBLISH = 2;
  // Update or fetch the configurable fields of the widget
  WIDGET_CONTENT_TYPE_CONFIG = 3;
  // Update or fetch the widget template
  WIDGET_CONTENT_TYPE_TEMPLATE = 4;
  // Update or fetch the widget metadata
  WIDGET_CONTENT_TYPE_METADATA = 5;
}

message GetWidgetsRequest {
  google.protobuf.StringValue business_id = 1;
}

message GetWidgetsResponse {
  repeated WidgetMetadata widgets = 1;
}

message GetWidgetByIdRequest {
  google.protobuf.StringValue widget_id = 1;
  google.protobuf.StringValue business_id = 2;
  WidgetOptions widget_options = 3;
}

message GetWidgetByIdResponse {
  Widget widget = 1;
}

// The metadata used to update the WidgetMetadata. Excludes the status since that can only be directly updated via
// UpdateWidgetStatus.
message UpdateWidgetMetadata {
  google.protobuf.StringValue widget_name = 1;
  google.protobuf.StringValue merchant_website_url = 2;
}

// Customizable data to be updated for the widget
message UpdateWidgetData {
  google.protobuf.StringValue widget_data_raw = 1;
  UpdateWidgetMetadata widget_metadata = 2;
}

// The type of widget - corresponds to a specific template
enum WidgetType {
  // Default
  WIDGET_TYPE_UNSPECIFIED = 0;
  // Modal Web Widget
  WIDGET_TYPE_MODAL = 1;
}

// The widget preset - corresponds to a specific set of default configuration values
enum WidgetPreset {
  // Default
  WIDGET_PRESET_UNSPECIFIED = 0;
  // Evergreen/Ongoing Widget
  WIDGET_PRESET_EVERGREEN = 1;
  // Promo/Limited Time Offer Widget
  WIDGET_PRESET_LIMITED_TIME_OFFER = 2;
}

message CreateWidgetData {
  google.protobuf.StringValue widget_name = 1;
  google.protobuf.StringValue merchant_website_url = 2;
  WidgetType widget_type = 3;
  WidgetPreset widget_preset = 4;
}

message CreateWidgetRequest {
  google.protobuf.StringValue business_id = 1;
  CreateWidgetData create_widget_data = 2;
}

message CreateWidgetResponse {
  Widget widget = 1;
}

message UpdateWidgetByIdRequest {
  google.protobuf.StringValue widget_id = 1;
  google.protobuf.StringValue business_id = 2;
  UpdateWidgetData update_widget_data = 3;
  WidgetOptions widget_options = 4;
}

message UpdateWidgetByIdResponse {
  Widget widget = 1;
}

message WidgetAccountInfo {
  google.protobuf.StringValue account_url = 1;
}

message GetOrCreateWidgetAccountRequest {
  google.protobuf.StringValue business_id = 1;
}

message GetOrCreateWidgetAccountResponse {
  WidgetAccountInfo account_info = 1;
}

message PublishWidgetRequest {
  google.protobuf.StringValue business_id = 1;
  google.protobuf.StringValue widget_id = 2;
}

message PublishWidgetResponse {
  google.protobuf.StringValue widget_id = 1;
  google.protobuf.StringValue publish_url = 2;
}

// The status that a widget can be in.
enum WidgetStatus {
  // Default
  WIDGET_STATUS_UNSPECIFIED = 0;
  // No live version but existing draft version
  WIDGET_STATUS_DRAFT = 1;
  // Published with no draft
  WIDGET_STATUS_ACTIVE = 2;
  // Published with pending draft
  WIDGET_STATUS_ACTIVE_WITH_PENDING_DRAFT = 3;
  // Widget archived (no published or draft versions)
  WIDGET_STATUS_ARCHIVED = 4;
  // The widget has been deleted.
  WIDGET_STATUS_DELETED = 5;
}

message UpdateWidgetStatusRequest {
  google.protobuf.StringValue business_id = 1;
  google.protobuf.StringValue widget_id = 2;
  // The desired status that the Widget should be left in. WidgetStatus.WIDGET_STATUS_UNSPECIFIED and
  // WidgetStatus.WIDGET_STATUS_ACTIVE_WITH_PENDING_DRAFT are not allowed.
  WidgetStatus desired_status = 3;
}

message UpdateWidgetStatusResponse {
  WidgetStatus final_status = 1;
}

message GetDeliveryTrackingPageUrlRequest {
  message Identifiers {
    // Various identifiers to look up an order for tracking page purposes
    oneof identifier {
      google.protobuf.StringValue unspecified_identifier = 1;
      google.protobuf.StringValue url_code = 2;
      google.protobuf.StringValue delivery_uuid = 3;
      google.protobuf.StringValue tracking_number = 4;
    }
  }
  Identifiers identifiers = 1;
}

message GetDeliveryTrackingPageUrlResponse {
  google.protobuf.StringValue delivery_tracking_page_url = 1;
}

message PortalConfigurationsForDriveFormRequest {
  google.protobuf.StringValue business_id = 1;
  google.protobuf.StringValue store_id = 2;
  Address store_address = 3 [deprecated = true];
  google.protobuf.StringValue store_country = 4;
}

message GetPortalConfigurationsForDriveFormResponse {
  // Show tips text box
  google.protobuf.BoolValue show_tips = 1;
  // Show cash question
  google.protobuf.BoolValue show_cash = 2;
  // Show alcohol question
  google.protobuf.BoolValue show_alcohol = 3;
  // Show which delivery type should be shown in option
  DeliveryTypes show_delivery_type = 4 [deprecated = true];
  // Default delivery type to be selected
  DeliveryTypes default_delivery_type = 5;
  // Default delivery instructions
  google.protobuf.StringValue default_delivery_instructions = 6;
  // Show prescription medication checkbox
  google.protobuf.BoolValue show_prescription_medication = 7;
  // Default prescription medication selection
  google.protobuf.BoolValue default_prescription_medication = 8;
  // Show restricted over the counter medication checkbox
  google.protobuf.BoolValue show_restricted_otc_medication = 9;
  // Default restricted over the counter medication selection
  google.protobuf.BoolValue default_restricted_otc_medication = 10;
  // Show restricted prescription medication checkbox
  google.protobuf.BoolValue show_restricted_prescription_medication = 11;
  // Default restricted prescription medication selection
  google.protobuf.BoolValue default_restricted_prescription_medication = 12;
  // Nationwide age restriction for pharma orders
  google.protobuf.Int32Value required_minimum_age_for_medication = 13;
  // Show delivery type question
  DeliveryTypes show_delivery_type_question = 14 [deprecated = true];
  // Show delivery type question
  google.protobuf.BoolValue show_delivery_types_question = 15;
  // Show over the counter medication checkbox
  google.protobuf.BoolValue show_otc_medication = 16;
  // Default over the counter medication selection
  google.protobuf.BoolValue default_otc_medication = 17;
  // Default diagnostic Lab order form
  // If set to true, special drive form for diagnostics type is shown
  google.protobuf.BoolValue default_diagnostics_lab_order = 18;
}

message DeliveryTypes {
  google.protobuf.BoolValue hand_it_to_me = 1;
  google.protobuf.BoolValue contactless = 2;
}

message DeliveryFulfillmentDetailsForPortalOrderRequest {
  google.protobuf.StringValue business_id = 1;
  google.protobuf.StringValue store_id = 2;
  Address store_address = 3 [deprecated = true];
  google.protobuf.BoolValue is_cash_order = 4;
  google.protobuf.BoolValue is_alcohol_order = 5;
  google.protobuf.BoolValue is_prescription_order = 6;
  google.protobuf.BoolValue is_restricted_otc_order = 7;
  google.protobuf.BoolValue is_restricted_prescription_order = 8;
  google.protobuf.StringValue store_country = 9;
  google.protobuf.StringValue store_state = 10;
  google.protobuf.BoolValue is_otc_order = 11;
  google.protobuf.BoolValue is_diagnostics_lab_order = 12;
}

message DeliveryFulfillmentDetailsForPortalOrderResponse {
  // Can be an error or success response
  oneof result {
    com.doordash.drive.api.portal.errors.v1.ErrorData error = 1;
    DeliveryFulfillmentDetailsData data = 2;
  }
}

// Request for UpdateOrderTrackingDelivery endpoint
message UpdateOrderTrackingDeliveryRequest {
  // Editable part of the dropoff details on the tracking page
  message DropoffDetails {
    // Editable part of the dropoff instructions on the tracking page
    message DropoffInstructions {
      // Only consists of cx dropoff instructions
      google.protobuf.StringValue cx_dropoff_instructions = 1;
      // Dropoff building name
      google.protobuf.StringValue building_name = 2;
      // Dropoff entry code for the address
      google.protobuf.StringValue entry_code = 3;
      // Dropoff subpremise info for the address
      google.protobuf.StringValue subpremise = 4;
    }

    // dropoff instruction portion of dropoff details
    DropoffInstructions dropoff_instruction_details = 1;
  }

  // Identifiers to identify the order to update
  message Identifiers {
    // Various identifiers to look up an order for tracking page purposes
    oneof identifier {
      google.protobuf.StringValue delivery_uuid = 1;
    }
  }

  // Identifiers to identify the order to update
  Identifiers identifiers = 1;
  // Editable part of the dropoff details on the tracking page
  DropoffDetails dropoff_details = 2;
  // Contains user context to localize error response on the backend
  com.doordash.drive.api.request_contexts.v1.RequestSubmissionContext submission_context = 3;
}

// Error Response for Cx Tracking Page
message OrderTrackingErrorData {
  // Error code to describe the type of error
  enum ErrorCode {
    // unspecified error code
    ERROR_CODE_UNSPECIFIED = 0;

    /** START -- generic error codes */
    // Generic internal error
    ERROR_CODE_INTERNAL_ERROR = 1;
    // Generic entity not found error
    ERROR_CODE_NOT_FOUND = 2;
    // Generic invalid request error
    ERROR_CODE_INVALID_REQUEST = 3;
    // Generic unauthorized error
    ERROR_CODE_UNAUTHORIZED = 4;
    // Generic required field error
    ERROR_CODE_REQUIRED_FIELD = 5;

    /** Delivery Instruction Specific error **/
    // delivery instructions is currently not in an editable state
    ERROR_CODE_DROPOFF_INSTRUCTIONS_UPDATE_DISABLED = 100;
  }
  // Error code to describe the type of error
  ErrorCode error_code = 1;
  // String message to further describe the error that can be exposed to Cx
  google.protobuf.StringValue localized_error_message_display = 2;
}

// Response for UpdateOrderTrackingDelivery endpoint
message UpdateOrderTrackingDeliveryResponse {
  // Message body to indicate the response was successful. Only populated on a
  // successful response
  message Data {
    // Order identifiers to identify the order on the tracking page
    message Identifiers {
      // Delivery uuid of the order
      string delivery_uuid = 1;
    }

    // Order identifiers to identify the order on the tracking page
    Identifiers identifiers = 1;
  }

  // Result of the UpdateOrderTrackingDelivery request
  oneof result {
    // Error data containing details if the update was not successful
    OrderTrackingErrorData error = 1;
    // Data to indicate that the response was successful
    Data data = 2;
  }
}

message DeliveryFulfillmentDetailsData {
  // Type of dropoff protocol - HITM, contactless
  DeliveryType delivery_type = 1;
  // Is signature required
  google.protobuf.BoolValue is_signature_required = 2;
  // Action to be taken upon return
  ReturnAction return_action = 3;
  // Dropoff pin code verification metadata
  PinCodeVerificationMetadata dropoff_pin_code_verification_metadata = 4;
  // Is barcode scanning required
  google.protobuf.BoolValue is_barcode_scanning_required = 5;
  // Default delivery details based on the request
  DefaultDeliveryDetails default_details = 6;

  // The Delivery Type
  enum DeliveryType {
    // Default
    DELIVERY_TYPE_UNSPECIFIED = 0;
    // Hand it to me
    DELIVERY_TYPE_HAND_IT_TO_ME = 1;
    // Contactless
    DELIVERY_TYPE_CONTACTLESS = 2;
  }

  // Action to be taken upon return
  enum ReturnAction {
    // Default
    RETURN_ACTION_UNSPECIFIED = 0;
    // Return the order to store
    RETURN_ACTION_RETURN_TO_STORE = 1;
    // Leave the order unattended
    RETURN_ACTION_LEAVE_UNATTENDED = 2;
  }
}

message DefaultDeliveryDetails {
  // Subtotal in cents
  google.protobuf.Int64Value default_subtotal_cents = 1;
  // Default dropoff info
  DefaultDropoffInfo default_dropoff_info = 2 [deprecated = true];
  // Allowed item types which will be used as prefix in item name during order creation
  repeated string item_types = 3;
  // Max allowed item count
  google.protobuf.Int32Value max_allowed_item_count = 4;
  // List of default dropoff locations
  repeated DefaultDropoffInfo default_dropoff_info_list = 5;
}

message DefaultDropoffInfo {
  // Dropoff Business location name will be used in cx first name
  google.protobuf.StringValue dropoff_first_name = 1;
  // Phone contact number for the dropoff location
  google.protobuf.StringValue phone_number = 2;
  // Address Info
  AddressCoordinates address_info = 3;
}
